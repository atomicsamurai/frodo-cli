// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`frodo script list "frodo script list --usage --long --directory test/e2e/exports/all-separate/everything": should list the usage of the scripts in the test/e2e/exports/all-separate/everything directory 1`] = `
"Name                    │UUID                                │Language│Context                  │Description                   │Used                                                                                   
ADFS Profile            │dbe0bf9a-72aa-49d5-8483-9db147985a47│JS      │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.adfs.transform)                                                            
  Normalization (JS)    │                                    │        │Transformation           │from ADFS                     │                                                                                       
Alpha endUserUIClient   │e232cff3-2460-47cd-80b2-36c86c0d0f06│JS      │Oauth2 Access Token      │Used by endUserUIClient       │no                                                                                     
  OAuth2 Access Token   │                                    │        │Modification             │                              │                                                                                       
  Modification Script   │                                    │        │                         │                              │                                                                                       
Alpha endUserUIClient   │e1db8a0a-0329-4962-a5bf-ecffaca376ae│JS      │Oidc Claims              │Used by endUserUIClient       │no                                                                                     
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                       
Alpha OAuth2 Access     │39c08084-1238-43e8-857f-2e11005eac49│JS      │Oauth2 Access Token      │Default alpha realm script for│yes (at application.RCSClient._provider.pluginsConfig.accessTokenModificationScript)   
  Token Modification    │                                    │        │Modification             │OAuth2 Access Token           │                                                                                       
  Script                │                                    │        │                         │Modification                  │                                                                                       
Alpha OIDC Claims       │cf3515f0-8278-4ee3-a530-1bad7424c416│JS      │Oidc Claims              │Default alpha realm script for│yes (at application.RCSClient._provider.pluginsConfig.oidcClaimsScript)                
  Script                │                                    │        │                         │OIDC claims                   │                                                                                       
Amazon Profile          │6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Amazon                   │                                                                                       
Apple Profile           │484e6246-dbc6-4288-97e6-54e55431402e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Apple                    │                                                                                       
Authentication Tree     │01e1a3c0-038b-4c16-956a-6c9d89328cff│JS      │Authentication Tree      │Default global script for a   │no                                                                                     
  Decision Node Script  │                                    │        │Decision Node            │scripted decision node        │                                                                                       
Check Username          │739bdc48-fd24-4c52-b353-88706d75558a│JS      │Authentication Tree      │Check if username has already │no                                                                                     
                        │                                    │        │Decision Node            │been collected.               │                                                                                       
Config Provider Node    │5e854779-6ec1-4c39-aeba-0477e0986646│JS      │Config Provider Node     │Script to provide values for a│no                                                                                     
  Script                │                                    │        │                         │config provider node          │                                                                                       
Custom Device Match     │d58977ed-0542-4147-8197-973ef7300191│JS      │Authentication Tree      │Custom Device Match Script    │no                                                                                     
  Script                │                                    │        │Decision Node            │                              │                                                                                       
Device Id (Match) -     │157298c0-7d31-4059-a95b-eeb08473b7e5│JS      │Authentication Client    │Default global script for     │no                                                                                     
  Client Side           │                                    │        │Side                     │client side Device Id (Match) │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Device Id (Match) -     │703dab1a-1921-4981-98dd-b8e5349d8548│JS      │Authentication Server    │Default global script for     │no                                                                                     
  Server Side           │                                    │        │Side                     │server side Device Id (Match) │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Device Profile Match    │13e3f263-9cd3-4844-8d1c-040fd0dd02eb│JS      │Authentication Tree      │Default global script template│no                                                                                     
  Template - Decision   │                                    │        │Decision Node            │for Device Profile Match      │                                                                                       
  Node Script           │                                    │        │                         │decision node script for      │                                                                                       
                        │                                    │        │                         │Authentication Tree           │                                                                                       
Facebook Profile        │bae1d54a-e97d-4997-aa5d-c027f21af82c│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Facebook                 │                                                                                       
ForgeRock Internal:     │c234ba0b-58a1-4cfd-9567-09edde980745│JS      │Oauth2 Access Token      │Internal token modification   │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)
  OAuth2 Access Token   │                                    │        │Modification             │script                        │                                                                                       
  Modification Script   │                                    │        │                         │                              │                                                                                       
ForgeRock Internal:     │1f389a3d-21cf-417c-a6d3-42ea620071f0│JS      │Oidc Claims              │Internal OIDC Claims script   │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)             
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                       
GitHub Profile          │a7a78773-445b-4eca-bb93-409e86bced81│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from GitHub                   │                                                                                       
GitHub Profile          │23143919-6b78-40c3-b25e-beca19b229e0│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.github.transform)                                                          
  Normalization (VS)    │                                    │        │Transformation           │from GitHub                   │                                                                                       
Google Profile          │58d29080-4563-480b-89bb-1e7719776a21│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.google.transform)                                                          
  Normalization         │                                    │        │Transformation           │from Google                   │                                                                                       
Instagram Profile       │1244e639-4a31-401d-ab61-d75133d8dc9e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Instagram                │                                                                                       
Itsme Profile           │3d97c436-42c0-4dd0-a571-ea6f34f752b3│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Itsme                    │                                                                                       
LinkedIn Profile        │8862ca8f-7770-4af5-a888-ac0df0947f36│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from LinkedIn                 │                                                                                       
Microsoft Profile       │73cecbfc-dad0-4395-be6a-6858ee3a80e5│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Microsoft                │                                                                                       
Normalized Profile to   │ed685f9f-5909-4726-86e8-22bd38b47663│Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                     
  Identity              │                                    │        │Transformation           │profile into an Identity      │                                                                                       
Normalized Profile to   │58c824ae-84ed-4724-82cd-db128fc3f6c │Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                     
  Managed User          │                                    │        │Transformation           │profile into a managed user   │                                                                                       
OAuth2 Access Token     │d22f9a0c-426a-4466-b95e-d0f125b0d5fa│JS      │Oauth2 Access Token      │Default global script for     │no                                                                                     
  Modification Script   │                                    │        │Modification             │OAuth2 Access Token           │                                                                                       
                        │                                    │        │                         │Modification                  │                                                                                       
OAuth2 Authorize        │3f93ef6e-e54a-4393-aba1-f322656db28a│JS      │Oauth2 Authorize Endpoint│Default global script for     │no                                                                                     
  Endpoint Data Provider│                                    │        │Data Provider            │OAuth2 Authorize Endpoint Data│                                                                                       
  Script                │                                    │        │                         │Provider                      │                                                                                       
OAuth2 Evaluate Scope   │da56fe60-8b38-4c46-a405-d6b306d4b336│JS      │Oauth2 Evaluate Scope    │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │OAuth2 Scope Evaluation       │                                                                                       
OAuth2 JWT Issuer       │400e48ba-3f13-4144-ac7b-f824ea8e98c5│JS      │Oauth2 Scripted Jwt      │Default global script for     │no                                                                                     
  Script                │                                    │        │Issuer                   │scripted JWT Issuers          │                                                                                       
OAuth2 May Act Script   │c735de08-f8f2-4e69-aa4a-2d8d3d438323│Groovy  │Oauth2 May Act           │Default global script for     │no                                                                                     
                        │                                    │        │                         │OAuth2 May Act                │                                                                                       
OAuth2 Validate Scope   │25e6c06d-cf70-473b-bd28-26931edc476b│JS      │Oauth2 Validate Scope    │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │OAuth2 Scope Validation       │                                                                                       
OIDC Claims Script      │36863ffb-40ec-48b9-94b1-9a99f71cc3b5│JS      │Oidc Claims              │Default global script for OIDC│no                                                                                     
                        │                                    │        │                         │claims                        │                                                                                       
Salesforce Profile      │312e951f-70c5-49d2-a9ae-93aef909d5df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Salesforce               │                                                                                       
SAML2 IDP Adapter       │248b8a56-df81-4b1b-b4ba-45d994f6504c│JS      │Saml2 Idp Adapter        │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │SAML2 IDP Adapter             │                                                                                       
SAML2 IDP Attribute     │c4f22465-2368-4e27-8013-e6399974fd48│JS      │Saml2 Idp Attribute      │Default global script for     │no                                                                                     
  Mapper Script         │                                    │        │Mapper                   │SAML2 IDP Attribute Mapper    │                                                                                       
SAML2 SP Adapter Script │69f06e63-128c-4e2f-af52-079a8a6f448b│JS      │Saml2 Sp Adapter         │Default global script for     │no                                                                                     
                        │                                    │        │                         │SAML2 SP Adapter              │                                                                                       
Scripted Module -       │c827d2b4-3608-4693-868e-bbcf86bd87c7│JS      │Authentication Client    │Default global script for     │no                                                                                     
  Client Side           │                                    │        │Side                     │client side Scripted          │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Scripted Module -       │7e3d7067-d50f-4674-8c76-a3e13a810c33│JS      │Authentication Server    │Default global script for     │no                                                                                     
  Server Side           │                                    │        │Side                     │server side Scripted          │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Scripted Policy         │9de3eb62-f131-4fac-a294-7bd170fd4acb│JS      │Policy Condition         │Default global script for     │no                                                                                     
  Condition             │                                    │        │                         │Scripted Policy Conditions    │                                                                                       
Social Identity         │1d475815-72cb-42eb-aafd-4026989d28a7│Groovy  │Social Idp Profile       │Default global script for     │no                                                                                     
  Provider Profile      │                                    │        │Transformation           │Social Identity Provider      │                                                                                       
  Transformation Script │                                    │        │                         │Profile Transformation        │                                                                                       
Test-Script-1           │59f84396-71e4-4c1d-a6ae-c4fc624d9752│JS      │Library                  │A test script that uses an    │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)       
                        │                                    │        │                         │environment variable and a    │                                                                                       
                        │                                    │        │                         │secret variable               │                                                                                       
Twitter Profile         │8e298710-b55e-4085-a464-88a375a4004b│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Twitter                  │                                                                                       
VKontakte Profile       │403cf226-6051-4368-8b72-9ba14f9a5140│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from VKontakte                │                                                                                       
WeChat Profile          │472534ec-a25f-468d-a606-3fb1935190df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from WeChat                   │                                                                                       
WordPress Profile       │91d197de-5916-4dca-83b5-9a4df26e7159│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from WordPress                │                                                                                       
Yahoo Profile           │424da748-82cc-4b54-be6f-82bd64d82a74│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Yahoo                    │                                                                                       
"
`;

exports[`frodo script list "frodo script list --usage --long --file test/e2e/exports/all/Alpha.everything.json": should list the usage of the scripts in the Alpha.everything.json file 1`] = `
"Name                    │UUID                                │Language│Context                  │Description                   │Used                                                                                   
ADFS Profile            │dbe0bf9a-72aa-49d5-8483-9db147985a47│JS      │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.adfs.transform)                                                            
  Normalization (JS)    │                                    │        │Transformation           │from ADFS                     │                                                                                       
Alpha endUserUIClient   │e232cff3-2460-47cd-80b2-36c86c0d0f06│JS      │Oauth2 Access Token      │Used by endUserUIClient       │no                                                                                     
  OAuth2 Access Token   │                                    │        │Modification             │                              │                                                                                       
  Modification Script   │                                    │        │                         │                              │                                                                                       
Alpha endUserUIClient   │e1db8a0a-0329-4962-a5bf-ecffaca376ae│JS      │Oidc Claims              │Used by endUserUIClient       │no                                                                                     
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                       
Alpha OAuth2 Access     │39c08084-1238-43e8-857f-2e11005eac49│JS      │Oauth2 Access Token      │Default alpha realm script for│yes (at application.RCSClient._provider.pluginsConfig.accessTokenModificationScript)   
  Token Modification    │                                    │        │Modification             │OAuth2 Access Token           │                                                                                       
  Script                │                                    │        │                         │Modification                  │                                                                                       
Alpha OIDC Claims       │cf3515f0-8278-4ee3-a530-1bad7424c416│JS      │Oidc Claims              │Default alpha realm script for│yes (at application.RCSClient._provider.pluginsConfig.oidcClaimsScript)                
  Script                │                                    │        │                         │OIDC claims                   │                                                                                       
Amazon Profile          │6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Amazon                   │                                                                                       
Apple Profile           │484e6246-dbc6-4288-97e6-54e55431402e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Apple                    │                                                                                       
Authentication Tree     │01e1a3c0-038b-4c16-956a-6c9d89328cff│JS      │Authentication Tree      │Default global script for a   │no                                                                                     
  Decision Node Script  │                                    │        │Decision Node            │scripted decision node        │                                                                                       
Check Username          │739bdc48-fd24-4c52-b353-88706d75558a│JS      │Authentication Tree      │Check if username has already │no                                                                                     
                        │                                    │        │Decision Node            │been collected.               │                                                                                       
Config Provider Node    │5e854779-6ec1-4c39-aeba-0477e0986646│JS      │Config Provider Node     │Script to provide values for a│no                                                                                     
  Script                │                                    │        │                         │config provider node          │                                                                                       
Custom Device Match     │d58977ed-0542-4147-8197-973ef7300191│JS      │Authentication Tree      │Custom Device Match Script    │no                                                                                     
  Script                │                                    │        │Decision Node            │                              │                                                                                       
Device Id (Match) -     │157298c0-7d31-4059-a95b-eeb08473b7e5│JS      │Authentication Client    │Default global script for     │no                                                                                     
  Client Side           │                                    │        │Side                     │client side Device Id (Match) │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Device Id (Match) -     │703dab1a-1921-4981-98dd-b8e5349d8548│JS      │Authentication Server    │Default global script for     │no                                                                                     
  Server Side           │                                    │        │Side                     │server side Device Id (Match) │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Device Profile Match    │13e3f263-9cd3-4844-8d1c-040fd0dd02eb│JS      │Authentication Tree      │Default global script template│no                                                                                     
  Template - Decision   │                                    │        │Decision Node            │for Device Profile Match      │                                                                                       
  Node Script           │                                    │        │                         │decision node script for      │                                                                                       
                        │                                    │        │                         │Authentication Tree           │                                                                                       
Facebook Profile        │bae1d54a-e97d-4997-aa5d-c027f21af82c│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Facebook                 │                                                                                       
ForgeRock Internal:     │c234ba0b-58a1-4cfd-9567-09edde980745│JS      │Oauth2 Access Token      │Internal token modification   │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)
  OAuth2 Access Token   │                                    │        │Modification             │script                        │                                                                                       
  Modification Script   │                                    │        │                         │                              │                                                                                       
ForgeRock Internal:     │1f389a3d-21cf-417c-a6d3-42ea620071f0│JS      │Oidc Claims              │Internal OIDC Claims script   │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)             
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                       
GitHub Profile          │a7a78773-445b-4eca-bb93-409e86bced81│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from GitHub                   │                                                                                       
GitHub Profile          │23143919-6b78-40c3-b25e-beca19b229e0│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.github.transform)                                                          
  Normalization (VS)    │                                    │        │Transformation           │from GitHub                   │                                                                                       
Google Profile          │58d29080-4563-480b-89bb-1e7719776a21│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.google.transform)                                                          
  Normalization         │                                    │        │Transformation           │from Google                   │                                                                                       
Instagram Profile       │1244e639-4a31-401d-ab61-d75133d8dc9e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Instagram                │                                                                                       
Itsme Profile           │3d97c436-42c0-4dd0-a571-ea6f34f752b3│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Itsme                    │                                                                                       
LinkedIn Profile        │8862ca8f-7770-4af5-a888-ac0df0947f36│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from LinkedIn                 │                                                                                       
Microsoft Profile       │73cecbfc-dad0-4395-be6a-6858ee3a80e5│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Microsoft                │                                                                                       
Normalized Profile to   │ed685f9f-5909-4726-86e8-22bd38b47663│Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                     
  Identity              │                                    │        │Transformation           │profile into an Identity      │                                                                                       
Normalized Profile to   │58c824ae-84ed-4724-82cd-db128fc3f6c │Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                     
  Managed User          │                                    │        │Transformation           │profile into a managed user   │                                                                                       
OAuth2 Access Token     │d22f9a0c-426a-4466-b95e-d0f125b0d5fa│JS      │Oauth2 Access Token      │Default global script for     │no                                                                                     
  Modification Script   │                                    │        │Modification             │OAuth2 Access Token           │                                                                                       
                        │                                    │        │                         │Modification                  │                                                                                       
OAuth2 Authorize        │3f93ef6e-e54a-4393-aba1-f322656db28a│JS      │Oauth2 Authorize Endpoint│Default global script for     │no                                                                                     
  Endpoint Data Provider│                                    │        │Data Provider            │OAuth2 Authorize Endpoint Data│                                                                                       
  Script                │                                    │        │                         │Provider                      │                                                                                       
OAuth2 Evaluate Scope   │da56fe60-8b38-4c46-a405-d6b306d4b336│JS      │Oauth2 Evaluate Scope    │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │OAuth2 Scope Evaluation       │                                                                                       
OAuth2 JWT Issuer       │400e48ba-3f13-4144-ac7b-f824ea8e98c5│JS      │Oauth2 Scripted Jwt      │Default global script for     │no                                                                                     
  Script                │                                    │        │Issuer                   │scripted JWT Issuers          │                                                                                       
OAuth2 May Act Script   │c735de08-f8f2-4e69-aa4a-2d8d3d438323│Groovy  │Oauth2 May Act           │Default global script for     │no                                                                                     
                        │                                    │        │                         │OAuth2 May Act                │                                                                                       
OAuth2 Validate Scope   │25e6c06d-cf70-473b-bd28-26931edc476b│JS      │Oauth2 Validate Scope    │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │OAuth2 Scope Validation       │                                                                                       
OIDC Claims Script      │36863ffb-40ec-48b9-94b1-9a99f71cc3b5│JS      │Oidc Claims              │Default global script for OIDC│no                                                                                     
                        │                                    │        │                         │claims                        │                                                                                       
Salesforce Profile      │312e951f-70c5-49d2-a9ae-93aef909d5df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Salesforce               │                                                                                       
SAML2 IDP Adapter       │248b8a56-df81-4b1b-b4ba-45d994f6504c│JS      │Saml2 Idp Adapter        │Default global script for     │no                                                                                     
  Script                │                                    │        │                         │SAML2 IDP Adapter             │                                                                                       
SAML2 IDP Attribute     │c4f22465-2368-4e27-8013-e6399974fd48│JS      │Saml2 Idp Attribute      │Default global script for     │no                                                                                     
  Mapper Script         │                                    │        │Mapper                   │SAML2 IDP Attribute Mapper    │                                                                                       
SAML2 SP Adapter Script │69f06e63-128c-4e2f-af52-079a8a6f448b│JS      │Saml2 Sp Adapter         │Default global script for     │no                                                                                     
                        │                                    │        │                         │SAML2 SP Adapter              │                                                                                       
Scripted Module -       │c827d2b4-3608-4693-868e-bbcf86bd87c7│JS      │Authentication Client    │Default global script for     │no                                                                                     
  Client Side           │                                    │        │Side                     │client side Scripted          │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Scripted Module -       │7e3d7067-d50f-4674-8c76-a3e13a810c33│JS      │Authentication Server    │Default global script for     │no                                                                                     
  Server Side           │                                    │        │Side                     │server side Scripted          │                                                                                       
                        │                                    │        │                         │Authentication Module         │                                                                                       
Scripted Policy         │9de3eb62-f131-4fac-a294-7bd170fd4acb│JS      │Policy Condition         │Default global script for     │no                                                                                     
  Condition             │                                    │        │                         │Scripted Policy Conditions    │                                                                                       
Social Identity         │1d475815-72cb-42eb-aafd-4026989d28a7│Groovy  │Social Idp Profile       │Default global script for     │no                                                                                     
  Provider Profile      │                                    │        │Transformation           │Social Identity Provider      │                                                                                       
  Transformation Script │                                    │        │                         │Profile Transformation        │                                                                                       
Test-Script-1           │59f84396-71e4-4c1d-a6ae-c4fc624d9752│JS      │Library                  │A test script that uses an    │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)       
                        │                                    │        │                         │environment variable and a    │                                                                                       
                        │                                    │        │                         │secret variable               │                                                                                       
Twitter Profile         │8e298710-b55e-4085-a464-88a375a4004b│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Twitter                  │                                                                                       
VKontakte Profile       │403cf226-6051-4368-8b72-9ba14f9a5140│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from VKontakte                │                                                                                       
WeChat Profile          │472534ec-a25f-468d-a606-3fb1935190df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from WeChat                   │                                                                                       
WordPress Profile       │91d197de-5916-4dca-83b5-9a4df26e7159│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from WordPress                │                                                                                       
Yahoo Profile           │424da748-82cc-4b54-be6f-82bd64d82a74│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                     
  Normalization         │                                    │        │Transformation           │from Yahoo                    │                                                                                       
"
`;

exports[`frodo script list "frodo script list -l": should list the names, uuids, languages, contexts, and descriptions of the scripts 1`] = `
"Name                    │UUID                                │Language│Context                  │Description                   
ADFS Profile            │dbe0bf9a-72aa-49d5-8483-9db147985a47│JS      │Social Idp Profile       │Normalizes raw profile data   
  Normalization (JS)    │                                    │        │Transformation           │from ADFS                     
Alpha endUserUIClient   │e232cff3-2460-47cd-80b2-36c86c0d0f06│JS      │Oauth2 Access Token      │Used by endUserUIClient       
  OAuth2 Access Token   │                                    │        │Modification             │                              
  Modification Script   │                                    │        │                         │                              
Alpha endUserUIClient   │e1db8a0a-0329-4962-a5bf-ecffaca376ae│JS      │Oidc Claims              │Used by endUserUIClient       
  OIDC Claims Script    │                                    │        │                         │                              
Alpha OAuth2 Access     │39c08084-1238-43e8-857f-2e11005eac49│JS      │Oauth2 Access Token      │Default alpha realm script for
  Token Modification    │                                    │        │Modification             │OAuth2 Access Token           
  Script                │                                    │        │                         │Modification                  
Alpha OIDC Claims       │cf3515f0-8278-4ee3-a530-1bad7424c416│JS      │Oidc Claims              │Default alpha realm script for
  Script                │                                    │        │                         │OIDC claims                   
Amazon Profile          │6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Amazon                   
Apple Profile           │484e6246-dbc6-4288-97e6-54e55431402e│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Apple                    
Authentication Tree     │01e1a3c0-038b-4c16-956a-6c9d89328cff│JS      │Authentication Tree      │Default global script for a   
  Decision Node Script  │                                    │        │Decision Node            │scripted decision node        
Check Username          │739bdc48-fd24-4c52-b353-88706d75558a│JS      │Authentication Tree      │Check if username has already 
                        │                                    │        │Decision Node            │been collected.               
Config Provider Node    │5e854779-6ec1-4c39-aeba-0477e0986646│JS      │Config Provider Node     │Script to provide values for a
  Script                │                                    │        │                         │config provider node          
Custom Device Match     │d58977ed-0542-4147-8197-973ef7300191│JS      │Authentication Tree      │Custom Device Match Script    
  Script                │                                    │        │Decision Node            │                              
Device Id (Match) -     │157298c0-7d31-4059-a95b-eeb08473b7e5│JS      │Authentication Client    │Default global script for     
  Client Side           │                                    │        │Side                     │client side Device Id (Match) 
                        │                                    │        │                         │Authentication Module         
Device Id (Match) -     │703dab1a-1921-4981-98dd-b8e5349d8548│JS      │Authentication Server    │Default global script for     
  Server Side           │                                    │        │Side                     │server side Device Id (Match) 
                        │                                    │        │                         │Authentication Module         
Device Profile Match    │13e3f263-9cd3-4844-8d1c-040fd0dd02eb│JS      │Authentication Tree      │Default global script template
  Template - Decision   │                                    │        │Decision Node            │for Device Profile Match      
  Node Script           │                                    │        │                         │decision node script for      
                        │                                    │        │                         │Authentication Tree           
Facebook Profile        │bae1d54a-e97d-4997-aa5d-c027f21af82c│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Facebook                 
ForgeRock Internal:     │c234ba0b-58a1-4cfd-9567-09edde980745│JS      │Oauth2 Access Token      │Internal token modification   
  OAuth2 Access Token   │                                    │        │Modification             │script                        
  Modification Script   │                                    │        │                         │                              
ForgeRock Internal:     │1f389a3d-21cf-417c-a6d3-42ea620071f0│JS      │Oidc Claims              │Internal OIDC Claims script   
  OIDC Claims Script    │                                    │        │                         │                              
GitHub Profile          │a7a78773-445b-4eca-bb93-409e86bced81│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from GitHub                   
GitHub Profile          │23143919-6b78-40c3-b25e-beca19b229e0│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization (VS)    │                                    │        │Transformation           │from GitHub                   
Google Profile          │58d29080-4563-480b-89bb-1e7719776a21│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Google                   
Instagram Profile       │1244e639-4a31-401d-ab61-d75133d8dc9e│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Instagram                
Itsme Profile           │3d97c436-42c0-4dd0-a571-ea6f34f752b3│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Itsme                    
LinkedIn Profile        │8862ca8f-7770-4af5-a888-ac0df0947f36│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from LinkedIn                 
Microsoft Profile       │73cecbfc-dad0-4395-be6a-6858ee3a80e5│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Microsoft                
Normalized Profile to   │ed685f9f-5909-4726-86e8-22bd38b47663│Groovy  │Social Idp Profile       │Converts a normalized social  
  Identity              │                                    │        │Transformation           │profile into an Identity      
Normalized Profile to   │58c824ae-84ed-4724-82cd-db128fc3f6c │Groovy  │Social Idp Profile       │Converts a normalized social  
  Managed User          │                                    │        │Transformation           │profile into a managed user   
OAuth2 Access Token     │d22f9a0c-426a-4466-b95e-d0f125b0d5fa│JS      │Oauth2 Access Token      │Default global script for     
  Modification Script   │                                    │        │Modification             │OAuth2 Access Token           
                        │                                    │        │                         │Modification                  
OAuth2 Authorize        │3f93ef6e-e54a-4393-aba1-f322656db28a│JS      │Oauth2 Authorize Endpoint│Default global script for     
  Endpoint Data Provider│                                    │        │Data Provider            │OAuth2 Authorize Endpoint Data
  Script                │                                    │        │                         │Provider                      
OAuth2 Evaluate Scope   │da56fe60-8b38-4c46-a405-d6b306d4b336│JS      │Oauth2 Evaluate Scope    │Default global script for     
  Script                │                                    │        │                         │OAuth2 Scope Evaluation       
OAuth2 JWT Issuer       │400e48ba-3f13-4144-ac7b-f824ea8e98c5│JS      │Oauth2 Scripted Jwt      │Default global script for     
  Script                │                                    │        │Issuer                   │scripted JWT Issuers          
OAuth2 May Act Script   │c735de08-f8f2-4e69-aa4a-2d8d3d438323│Groovy  │Oauth2 May Act           │Default global script for     
                        │                                    │        │                         │OAuth2 May Act                
OAuth2 Validate Scope   │25e6c06d-cf70-473b-bd28-26931edc476b│JS      │Oauth2 Validate Scope    │Default global script for     
  Script                │                                    │        │                         │OAuth2 Scope Validation       
OIDC Claims Script      │36863ffb-40ec-48b9-94b1-9a99f71cc3b5│JS      │Oidc Claims              │Default global script for OIDC
                        │                                    │        │                         │claims                        
Salesforce Profile      │312e951f-70c5-49d2-a9ae-93aef909d5df│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Salesforce               
SAML2 IDP Adapter       │248b8a56-df81-4b1b-b4ba-45d994f6504c│JS      │Saml2 Idp Adapter        │Default global script for     
  Script                │                                    │        │                         │SAML2 IDP Adapter             
SAML2 IDP Attribute     │c4f22465-2368-4e27-8013-e6399974fd48│JS      │Saml2 Idp Attribute      │Default global script for     
  Mapper Script         │                                    │        │Mapper                   │SAML2 IDP Attribute Mapper    
SAML2 SP Adapter Script │69f06e63-128c-4e2f-af52-079a8a6f448b│JS      │Saml2 Sp Adapter         │Default global script for     
                        │                                    │        │                         │SAML2 SP Adapter              
Scripted Module -       │c827d2b4-3608-4693-868e-bbcf86bd87c7│JS      │Authentication Client    │Default global script for     
  Client Side           │                                    │        │Side                     │client side Scripted          
                        │                                    │        │                         │Authentication Module         
Scripted Module -       │7e3d7067-d50f-4674-8c76-a3e13a810c33│JS      │Authentication Server    │Default global script for     
  Server Side           │                                    │        │Side                     │server side Scripted          
                        │                                    │        │                         │Authentication Module         
Scripted Policy         │9de3eb62-f131-4fac-a294-7bd170fd4acb│JS      │Policy Condition         │Default global script for     
  Condition             │                                    │        │                         │Scripted Policy Conditions    
Social Identity         │1d475815-72cb-42eb-aafd-4026989d28a7│Groovy  │Social Idp Profile       │Default global script for     
  Provider Profile      │                                    │        │Transformation           │Social Identity Provider      
  Transformation Script │                                    │        │                         │Profile Transformation        
Test-Script-1           │59f84396-71e4-4c1d-a6ae-c4fc624d9752│JS      │Library                  │A test script that uses an    
                        │                                    │        │                         │environment variable and a    
                        │                                    │        │                         │secret variable               
Twitter Profile         │8e298710-b55e-4085-a464-88a375a4004b│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Twitter                  
VKontakte Profile       │403cf226-6051-4368-8b72-9ba14f9a5140│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from VKontakte                
WeChat Profile          │472534ec-a25f-468d-a606-3fb1935190df│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from WeChat                   
WordPress Profile       │91d197de-5916-4dca-83b5-9a4df26e7159│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from WordPress                
Yahoo Profile           │424da748-82cc-4b54-be6f-82bd64d82a74│Groovy  │Social Idp Profile       │Normalizes raw profile data   
  Normalization         │                                    │        │Transformation           │from Yahoo                    
"
`;

exports[`frodo script list "frodo script list -lu": should list the names, uuids, languages, contexts, usage, and descriptions of the scripts 1`] = `
"Name                    │UUID                                │Language│Context                  │Description                   │Used                                                                                      
ADFS Profile            │dbe0bf9a-72aa-49d5-8483-9db147985a47│JS      │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.adfs.transform)                                                               
  Normalization (JS)    │                                    │        │Transformation           │from ADFS                     │                                                                                          
Alpha endUserUIClient   │e232cff3-2460-47cd-80b2-36c86c0d0f06│JS      │Oauth2 Access Token      │Used by endUserUIClient       │no                                                                                        
  OAuth2 Access Token   │                                    │        │Modification             │                              │                                                                                          
  Modification Script   │                                    │        │                         │                              │                                                                                          
Alpha endUserUIClient   │e1db8a0a-0329-4962-a5bf-ecffaca376ae│JS      │Oidc Claims              │Used by endUserUIClient       │no                                                                                        
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                          
Alpha OAuth2 Access     │39c08084-1238-43e8-857f-2e11005eac49│JS      │Oauth2 Access Token      │Default alpha realm script for│yes (at application.rfc7523-client1._provider.pluginsConfig.accessTokenModificationScript)
  Token Modification    │                                    │        │Modification             │OAuth2 Access Token           │                                                                                          
  Script                │                                    │        │                         │Modification                  │                                                                                          
Alpha OIDC Claims       │cf3515f0-8278-4ee3-a530-1bad7424c416│JS      │Oidc Claims              │Default alpha realm script for│yes (at application.rfc7523-client1._provider.pluginsConfig.oidcClaimsScript)             
  Script                │                                    │        │                         │OIDC claims                   │                                                                                          
Amazon Profile          │6b3cfd48-62d3-48ff-a96f-fe8f3a22ab30│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Amazon                   │                                                                                          
Apple Profile           │484e6246-dbc6-4288-97e6-54e55431402e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Apple                    │                                                                                          
Authentication Tree     │01e1a3c0-038b-4c16-956a-6c9d89328cff│JS      │Authentication Tree      │Default global script for a   │no                                                                                        
  Decision Node Script  │                                    │        │Decision Node            │scripted decision node        │                                                                                          
Check Username          │739bdc48-fd24-4c52-b353-88706d75558a│JS      │Authentication Tree      │Check if username has already │no                                                                                        
                        │                                    │        │Decision Node            │been collected.               │                                                                                          
Config Provider Node    │5e854779-6ec1-4c39-aeba-0477e0986646│JS      │Config Provider Node     │Script to provide values for a│no                                                                                        
  Script                │                                    │        │                         │config provider node          │                                                                                          
Custom Device Match     │d58977ed-0542-4147-8197-973ef7300191│JS      │Authentication Tree      │Custom Device Match Script    │no                                                                                        
  Script                │                                    │        │Decision Node            │                              │                                                                                          
Device Id (Match) -     │157298c0-7d31-4059-a95b-eeb08473b7e5│JS      │Authentication Client    │Default global script for     │no                                                                                        
  Client Side           │                                    │        │Side                     │client side Device Id (Match) │                                                                                          
                        │                                    │        │                         │Authentication Module         │                                                                                          
Device Id (Match) -     │703dab1a-1921-4981-98dd-b8e5349d8548│JS      │Authentication Server    │Default global script for     │no                                                                                        
  Server Side           │                                    │        │Side                     │server side Device Id (Match) │                                                                                          
                        │                                    │        │                         │Authentication Module         │                                                                                          
Device Profile Match    │13e3f263-9cd3-4844-8d1c-040fd0dd02eb│JS      │Authentication Tree      │Default global script template│no                                                                                        
  Template - Decision   │                                    │        │Decision Node            │for Device Profile Match      │                                                                                          
  Node Script           │                                    │        │                         │decision node script for      │                                                                                          
                        │                                    │        │                         │Authentication Tree           │                                                                                          
Facebook Profile        │bae1d54a-e97d-4997-aa5d-c027f21af82c│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Facebook                 │                                                                                          
ForgeRock Internal:     │c234ba0b-58a1-4cfd-9567-09edde980745│JS      │Oauth2 Access Token      │Internal token modification   │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)   
  OAuth2 Access Token   │                                    │        │Modification             │script                        │                                                                                          
  Modification Script   │                                    │        │                         │                              │                                                                                          
ForgeRock Internal:     │1f389a3d-21cf-417c-a6d3-42ea620071f0│JS      │Oidc Claims              │Internal OIDC Claims script   │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)                
  OIDC Claims Script    │                                    │        │                         │                              │                                                                                          
GitHub Profile          │a7a78773-445b-4eca-bb93-409e86bced81│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from GitHub                   │                                                                                          
GitHub Profile          │23143919-6b78-40c3-b25e-beca19b229e0│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.github.transform)                                                             
  Normalization (VS)    │                                    │        │Transformation           │from GitHub                   │                                                                                          
Google Profile          │58d29080-4563-480b-89bb-1e7719776a21│Groovy  │Social Idp Profile       │Normalizes raw profile data   │yes (at idp.google.transform)                                                             
  Normalization         │                                    │        │Transformation           │from Google                   │                                                                                          
Instagram Profile       │1244e639-4a31-401d-ab61-d75133d8dc9e│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Instagram                │                                                                                          
Itsme Profile           │3d97c436-42c0-4dd0-a571-ea6f34f752b3│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Itsme                    │                                                                                          
LinkedIn Profile        │8862ca8f-7770-4af5-a888-ac0df0947f36│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from LinkedIn                 │                                                                                          
Microsoft Profile       │73cecbfc-dad0-4395-be6a-6858ee3a80e5│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Microsoft                │                                                                                          
Normalized Profile to   │ed685f9f-5909-4726-86e8-22bd38b47663│Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                        
  Identity              │                                    │        │Transformation           │profile into an Identity      │                                                                                          
Normalized Profile to   │58c824ae-84ed-4724-82cd-db128fc3f6c │Groovy  │Social Idp Profile       │Converts a normalized social  │no                                                                                        
  Managed User          │                                    │        │Transformation           │profile into a managed user   │                                                                                          
OAuth2 Access Token     │d22f9a0c-426a-4466-b95e-d0f125b0d5fa│JS      │Oauth2 Access Token      │Default global script for     │no                                                                                        
  Modification Script   │                                    │        │Modification             │OAuth2 Access Token           │                                                                                          
                        │                                    │        │                         │Modification                  │                                                                                          
OAuth2 Authorize        │3f93ef6e-e54a-4393-aba1-f322656db28a│JS      │Oauth2 Authorize Endpoint│Default global script for     │no                                                                                        
  Endpoint Data Provider│                                    │        │Data Provider            │OAuth2 Authorize Endpoint Data│                                                                                          
  Script                │                                    │        │                         │Provider                      │                                                                                          
OAuth2 Evaluate Scope   │da56fe60-8b38-4c46-a405-d6b306d4b336│JS      │Oauth2 Evaluate Scope    │Default global script for     │no                                                                                        
  Script                │                                    │        │                         │OAuth2 Scope Evaluation       │                                                                                          
OAuth2 JWT Issuer       │400e48ba-3f13-4144-ac7b-f824ea8e98c5│JS      │Oauth2 Scripted Jwt      │Default global script for     │no                                                                                        
  Script                │                                    │        │Issuer                   │scripted JWT Issuers          │                                                                                          
OAuth2 May Act Script   │c735de08-f8f2-4e69-aa4a-2d8d3d438323│Groovy  │Oauth2 May Act           │Default global script for     │no                                                                                        
                        │                                    │        │                         │OAuth2 May Act                │                                                                                          
OAuth2 Validate Scope   │25e6c06d-cf70-473b-bd28-26931edc476b│JS      │Oauth2 Validate Scope    │Default global script for     │no                                                                                        
  Script                │                                    │        │                         │OAuth2 Scope Validation       │                                                                                          
OIDC Claims Script      │36863ffb-40ec-48b9-94b1-9a99f71cc3b5│JS      │Oidc Claims              │Default global script for OIDC│no                                                                                        
                        │                                    │        │                         │claims                        │                                                                                          
Salesforce Profile      │312e951f-70c5-49d2-a9ae-93aef909d5df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Salesforce               │                                                                                          
SAML2 IDP Adapter       │248b8a56-df81-4b1b-b4ba-45d994f6504c│JS      │Saml2 Idp Adapter        │Default global script for     │no                                                                                        
  Script                │                                    │        │                         │SAML2 IDP Adapter             │                                                                                          
SAML2 IDP Attribute     │c4f22465-2368-4e27-8013-e6399974fd48│JS      │Saml2 Idp Attribute      │Default global script for     │no                                                                                        
  Mapper Script         │                                    │        │Mapper                   │SAML2 IDP Attribute Mapper    │                                                                                          
SAML2 SP Adapter Script │69f06e63-128c-4e2f-af52-079a8a6f448b│JS      │Saml2 Sp Adapter         │Default global script for     │no                                                                                        
                        │                                    │        │                         │SAML2 SP Adapter              │                                                                                          
Scripted Module -       │c827d2b4-3608-4693-868e-bbcf86bd87c7│JS      │Authentication Client    │Default global script for     │no                                                                                        
  Client Side           │                                    │        │Side                     │client side Scripted          │                                                                                          
                        │                                    │        │                         │Authentication Module         │                                                                                          
Scripted Module -       │7e3d7067-d50f-4674-8c76-a3e13a810c33│JS      │Authentication Server    │Default global script for     │no                                                                                        
  Server Side           │                                    │        │Side                     │server side Scripted          │                                                                                          
                        │                                    │        │                         │Authentication Module         │                                                                                          
Scripted Policy         │9de3eb62-f131-4fac-a294-7bd170fd4acb│JS      │Policy Condition         │Default global script for     │no                                                                                        
  Condition             │                                    │        │                         │Scripted Policy Conditions    │                                                                                          
Social Identity         │1d475815-72cb-42eb-aafd-4026989d28a7│Groovy  │Social Idp Profile       │Default global script for     │no                                                                                        
  Provider Profile      │                                    │        │Transformation           │Social Identity Provider      │                                                                                          
  Transformation Script │                                    │        │                         │Profile Transformation        │                                                                                          
Test-Script-1           │59f84396-71e4-4c1d-a6ae-c4fc624d9752│JS      │Library                  │A test script that uses an    │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)          
                        │                                    │        │                         │environment variable and a    │                                                                                          
                        │                                    │        │                         │secret variable               │                                                                                          
Twitter Profile         │8e298710-b55e-4085-a464-88a375a4004b│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Twitter                  │                                                                                          
VKontakte Profile       │403cf226-6051-4368-8b72-9ba14f9a5140│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from VKontakte                │                                                                                          
WeChat Profile          │472534ec-a25f-468d-a606-3fb1935190df│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from WeChat                   │                                                                                          
WordPress Profile       │91d197de-5916-4dca-83b5-9a4df26e7159│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from WordPress                │                                                                                          
Yahoo Profile           │424da748-82cc-4b54-be6f-82bd64d82a74│Groovy  │Social Idp Profile       │Normalizes raw profile data   │no                                                                                        
  Normalization         │                                    │        │Transformation           │from Yahoo                    │                                                                                          
"
`;

exports[`frodo script list "frodo script list -u": should list the usage of the scripts 1`] = `
"Name                    │Used                                                                                      
ADFS Profile            │yes (at idp.adfs.transform)                                                               
  Normalization (JS)    │                                                                                          
Alpha endUserUIClient   │no                                                                                        
  OAuth2 Access Token   │                                                                                          
  Modification Script   │                                                                                          
Alpha endUserUIClient   │no                                                                                        
  OIDC Claims Script    │                                                                                          
Alpha OAuth2 Access     │yes (at application.rfc7523-client1._provider.pluginsConfig.accessTokenModificationScript)
  Token Modification    │                                                                                          
  Script                │                                                                                          
Alpha OIDC Claims       │yes (at application.rfc7523-client1._provider.pluginsConfig.oidcClaimsScript)             
  Script                │                                                                                          
Amazon Profile          │no                                                                                        
  Normalization         │                                                                                          
Apple Profile           │no                                                                                        
  Normalization         │                                                                                          
Authentication Tree     │no                                                                                        
  Decision Node Script  │                                                                                          
Check Username          │no                                                                                        
Config Provider Node    │no                                                                                        
  Script                │                                                                                          
Custom Device Match     │no                                                                                        
  Script                │                                                                                          
Device Id (Match) -     │no                                                                                        
  Client Side           │                                                                                          
Device Id (Match) -     │no                                                                                        
  Server Side           │                                                                                          
Device Profile Match    │no                                                                                        
  Template - Decision   │                                                                                          
  Node Script           │                                                                                          
Facebook Profile        │no                                                                                        
  Normalization         │                                                                                          
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)   
  OAuth2 Access Token   │                                                                                          
  Modification Script   │                                                                                          
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)                
  OIDC Claims Script    │                                                                                          
GitHub Profile          │no                                                                                        
  Normalization         │                                                                                          
GitHub Profile          │yes (at idp.github.transform)                                                             
  Normalization (VS)    │                                                                                          
Google Profile          │yes (at idp.google.transform)                                                             
  Normalization         │                                                                                          
Instagram Profile       │no                                                                                        
  Normalization         │                                                                                          
Itsme Profile           │no                                                                                        
  Normalization         │                                                                                          
LinkedIn Profile        │no                                                                                        
  Normalization         │                                                                                          
Microsoft Profile       │no                                                                                        
  Normalization         │                                                                                          
Normalized Profile to   │no                                                                                        
  Identity              │                                                                                          
Normalized Profile to   │no                                                                                        
  Managed User          │                                                                                          
OAuth2 Access Token     │no                                                                                        
  Modification Script   │                                                                                          
OAuth2 Authorize        │no                                                                                        
  Endpoint Data Provider│                                                                                          
  Script                │                                                                                          
OAuth2 Evaluate Scope   │no                                                                                        
  Script                │                                                                                          
OAuth2 JWT Issuer       │no                                                                                        
  Script                │                                                                                          
OAuth2 May Act Script   │no                                                                                        
OAuth2 Validate Scope   │no                                                                                        
  Script                │                                                                                          
OIDC Claims Script      │no                                                                                        
Salesforce Profile      │no                                                                                        
  Normalization         │                                                                                          
SAML2 IDP Adapter       │no                                                                                        
  Script                │                                                                                          
SAML2 IDP Attribute     │no                                                                                        
  Mapper Script         │                                                                                          
SAML2 SP Adapter Script │no                                                                                        
Scripted Module -       │no                                                                                        
  Client Side           │                                                                                          
Scripted Module -       │no                                                                                        
  Server Side           │                                                                                          
Scripted Policy         │no                                                                                        
  Condition             │                                                                                          
Social Identity         │no                                                                                        
  Provider Profile      │                                                                                          
  Transformation Script │                                                                                          
Test-Script-1           │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)          
Twitter Profile         │no                                                                                        
  Normalization         │                                                                                          
VKontakte Profile       │no                                                                                        
  Normalization         │                                                                                          
WeChat Profile          │no                                                                                        
  Normalization         │                                                                                          
WordPress Profile       │no                                                                                        
  Normalization         │                                                                                          
Yahoo Profile           │no                                                                                        
  Normalization         │                                                                                          
"
`;

exports[`frodo script list "frodo script list -uD test/e2e/exports/all-separate/everything": should list the usage of the scripts in the test/e2e/exports/all-separate/everything directory 1`] = `
"Name                    │Used                                                                                   
ADFS Profile            │yes (at idp.adfs.transform)                                                            
  Normalization (JS)    │                                                                                       
Alpha endUserUIClient   │no                                                                                     
  OAuth2 Access Token   │                                                                                       
  Modification Script   │                                                                                       
Alpha endUserUIClient   │no                                                                                     
  OIDC Claims Script    │                                                                                       
Alpha OAuth2 Access     │yes (at application.RCSClient._provider.pluginsConfig.accessTokenModificationScript)   
  Token Modification    │                                                                                       
  Script                │                                                                                       
Alpha OIDC Claims       │yes (at application.RCSClient._provider.pluginsConfig.oidcClaimsScript)                
  Script                │                                                                                       
Amazon Profile          │no                                                                                     
  Normalization         │                                                                                       
Apple Profile           │no                                                                                     
  Normalization         │                                                                                       
Authentication Tree     │no                                                                                     
  Decision Node Script  │                                                                                       
Check Username          │no                                                                                     
Config Provider Node    │no                                                                                     
  Script                │                                                                                       
Custom Device Match     │no                                                                                     
  Script                │                                                                                       
Device Id (Match) -     │no                                                                                     
  Client Side           │                                                                                       
Device Id (Match) -     │no                                                                                     
  Server Side           │                                                                                       
Device Profile Match    │no                                                                                     
  Template - Decision   │                                                                                       
  Node Script           │                                                                                       
Facebook Profile        │no                                                                                     
  Normalization         │                                                                                       
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)
  OAuth2 Access Token   │                                                                                       
  Modification Script   │                                                                                       
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)             
  OIDC Claims Script    │                                                                                       
GitHub Profile          │no                                                                                     
  Normalization         │                                                                                       
GitHub Profile          │yes (at idp.github.transform)                                                          
  Normalization (VS)    │                                                                                       
Google Profile          │yes (at idp.google.transform)                                                          
  Normalization         │                                                                                       
Instagram Profile       │no                                                                                     
  Normalization         │                                                                                       
Itsme Profile           │no                                                                                     
  Normalization         │                                                                                       
LinkedIn Profile        │no                                                                                     
  Normalization         │                                                                                       
Microsoft Profile       │no                                                                                     
  Normalization         │                                                                                       
Normalized Profile to   │no                                                                                     
  Identity              │                                                                                       
Normalized Profile to   │no                                                                                     
  Managed User          │                                                                                       
OAuth2 Access Token     │no                                                                                     
  Modification Script   │                                                                                       
OAuth2 Authorize        │no                                                                                     
  Endpoint Data Provider│                                                                                       
  Script                │                                                                                       
OAuth2 Evaluate Scope   │no                                                                                     
  Script                │                                                                                       
OAuth2 JWT Issuer       │no                                                                                     
  Script                │                                                                                       
OAuth2 May Act Script   │no                                                                                     
OAuth2 Validate Scope   │no                                                                                     
  Script                │                                                                                       
OIDC Claims Script      │no                                                                                     
Salesforce Profile      │no                                                                                     
  Normalization         │                                                                                       
SAML2 IDP Adapter       │no                                                                                     
  Script                │                                                                                       
SAML2 IDP Attribute     │no                                                                                     
  Mapper Script         │                                                                                       
SAML2 SP Adapter Script │no                                                                                     
Scripted Module -       │no                                                                                     
  Client Side           │                                                                                       
Scripted Module -       │no                                                                                     
  Server Side           │                                                                                       
Scripted Policy         │no                                                                                     
  Condition             │                                                                                       
Social Identity         │no                                                                                     
  Provider Profile      │                                                                                       
  Transformation Script │                                                                                       
Test-Script-1           │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)       
Twitter Profile         │no                                                                                     
  Normalization         │                                                                                       
VKontakte Profile       │no                                                                                     
  Normalization         │                                                                                       
WeChat Profile          │no                                                                                     
  Normalization         │                                                                                       
WordPress Profile       │no                                                                                     
  Normalization         │                                                                                       
Yahoo Profile           │no                                                                                     
  Normalization         │                                                                                       
"
`;

exports[`frodo script list "frodo script list -uf test/e2e/exports/all/Alpha.everything.json": should list the usage of the scripts in the Alpha.everything.json file 1`] = `
"Name                    │Used                                                                                   
ADFS Profile            │yes (at idp.adfs.transform)                                                            
  Normalization (JS)    │                                                                                       
Alpha endUserUIClient   │no                                                                                     
  OAuth2 Access Token   │                                                                                       
  Modification Script   │                                                                                       
Alpha endUserUIClient   │no                                                                                     
  OIDC Claims Script    │                                                                                       
Alpha OAuth2 Access     │yes (at application.RCSClient._provider.pluginsConfig.accessTokenModificationScript)   
  Token Modification    │                                                                                       
  Script                │                                                                                       
Alpha OIDC Claims       │yes (at application.RCSClient._provider.pluginsConfig.oidcClaimsScript)                
  Script                │                                                                                       
Amazon Profile          │no                                                                                     
  Normalization         │                                                                                       
Apple Profile           │no                                                                                     
  Normalization         │                                                                                       
Authentication Tree     │no                                                                                     
  Decision Node Script  │                                                                                       
Check Username          │no                                                                                     
Config Provider Node    │no                                                                                     
  Script                │                                                                                       
Custom Device Match     │no                                                                                     
  Script                │                                                                                       
Device Id (Match) -     │no                                                                                     
  Client Side           │                                                                                       
Device Id (Match) -     │no                                                                                     
  Server Side           │                                                                                       
Device Profile Match    │no                                                                                     
  Template - Decision   │                                                                                       
  Node Script           │                                                                                       
Facebook Profile        │no                                                                                     
  Normalization         │                                                                                       
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.accessTokenModificationScript)
  OAuth2 Access Token   │                                                                                       
  Modification Script   │                                                                                       
ForgeRock Internal:     │yes (at application.RCSClient.overrideOAuth2ClientConfig.oidcClaimsScript)             
  OIDC Claims Script    │                                                                                       
GitHub Profile          │no                                                                                     
  Normalization         │                                                                                       
GitHub Profile          │yes (at idp.github.transform)                                                          
  Normalization (VS)    │                                                                                       
Google Profile          │yes (at idp.google.transform)                                                          
  Normalization         │                                                                                       
Instagram Profile       │no                                                                                     
  Normalization         │                                                                                       
Itsme Profile           │no                                                                                     
  Normalization         │                                                                                       
LinkedIn Profile        │no                                                                                     
  Normalization         │                                                                                       
Microsoft Profile       │no                                                                                     
  Normalization         │                                                                                       
Normalized Profile to   │no                                                                                     
  Identity              │                                                                                       
Normalized Profile to   │no                                                                                     
  Managed User          │                                                                                       
OAuth2 Access Token     │no                                                                                     
  Modification Script   │                                                                                       
OAuth2 Authorize        │no                                                                                     
  Endpoint Data Provider│                                                                                       
  Script                │                                                                                       
OAuth2 Evaluate Scope   │no                                                                                     
  Script                │                                                                                       
OAuth2 JWT Issuer       │no                                                                                     
  Script                │                                                                                       
OAuth2 May Act Script   │no                                                                                     
OAuth2 Validate Scope   │no                                                                                     
  Script                │                                                                                       
OIDC Claims Script      │no                                                                                     
Salesforce Profile      │no                                                                                     
  Normalization         │                                                                                       
SAML2 IDP Adapter       │no                                                                                     
  Script                │                                                                                       
SAML2 IDP Attribute     │no                                                                                     
  Mapper Script         │                                                                                       
SAML2 SP Adapter Script │no                                                                                     
Scripted Module -       │no                                                                                     
  Client Side           │                                                                                       
Scripted Module -       │no                                                                                     
  Server Side           │                                                                                       
Scripted Policy         │no                                                                                     
  Condition             │                                                                                       
Social Identity         │no                                                                                     
  Provider Profile      │                                                                                       
  Transformation Script │                                                                                       
Test-Script-1           │yes (at policy.Test Policy(name: 'Test Policy').condition.conditions.1.scriptId)       
Twitter Profile         │no                                                                                     
  Normalization         │                                                                                       
VKontakte Profile       │no                                                                                     
  Normalization         │                                                                                       
WeChat Profile          │no                                                                                     
  Normalization         │                                                                                       
WordPress Profile       │no                                                                                     
  Normalization         │                                                                                       
Yahoo Profile           │no                                                                                     
  Normalization         │                                                                                       
"
`;

exports[`frodo script list "frodo script list": should list the names of the scripts 1`] = `
"ADFS Profile Normalization (JS)
Alpha endUserUIClient OAuth2 Access Token Modification Script
Alpha endUserUIClient OIDC Claims Script
Alpha OAuth2 Access Token Modification Script
Alpha OIDC Claims Script
Amazon Profile Normalization
Apple Profile Normalization
Authentication Tree Decision Node Script
Check Username
Config Provider Node Script
Custom Device Match Script
Device Id (Match) - Client Side
Device Id (Match) - Server Side
Device Profile Match Template - Decision Node Script
Facebook Profile Normalization
ForgeRock Internal: OAuth2 Access Token Modification Script
ForgeRock Internal: OIDC Claims Script
GitHub Profile Normalization
GitHub Profile Normalization (VS)
Google Profile Normalization
Instagram Profile Normalization
Itsme Profile Normalization
LinkedIn Profile Normalization
Microsoft Profile Normalization
Normalized Profile to Identity
Normalized Profile to Managed User
OAuth2 Access Token Modification Script
OAuth2 Authorize Endpoint Data Provider Script
OAuth2 Evaluate Scope Script
OAuth2 JWT Issuer Script
OAuth2 May Act Script
OAuth2 Validate Scope Script
OIDC Claims Script
Salesforce Profile Normalization
SAML2 IDP Adapter Script
SAML2 IDP Attribute Mapper Script
SAML2 SP Adapter Script
Scripted Module - Client Side
Scripted Module - Server Side
Scripted Policy Condition
Social Identity Provider Profile Transformation Script
Test-Script-1
Twitter Profile Normalization
VKontakte Profile Normalization
WeChat Profile Normalization
WordPress Profile Normalization
Yahoo Profile Normalization
"
`;
