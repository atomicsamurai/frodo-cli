{
  "meta": {
    "exportDate": "2024-03-29T19:29:02.733Z",
    "exportTool": "frodo",
    "exportToolVersion": "v2.0.0-75 [v20.5.1]",
    "exportedBy": "volker.scheuber@forgerock.com",
    "origin": "https://openam-frodo-dev.forgeblocks.com/am",
    "originAmVersion": "7.5.0"
  },
  "script": {
    "743351b3-001a-4ec8-b3ac-a674ddb8de22": {
      "_id": "743351b3-001a-4ec8-b3ac-a674ddb8de22",
      "context": "AUTHENTICATION_TREE_DECISION_NODE",
      "createdBy": "null",
      "creationDate": 0,
      "default": false,
      "description": "Enrich user session with UOP class ID.",
      "evaluatorVersion": "1.0",
      "language": "JAVASCRIPT",
      "lastModifiedBy": "null",
      "lastModifiedDate": 0,
      "name": "UOP Enrich Session",
      "script": [
        "/* UOP Enrich Session",
        " *",
        " * Author: volker.scheuber@forgerock.com",
        " * ",
        " * Add current class ID to user session.",
        " * ",
        " * This script does not need to be parametrized. It will work properly as is. ",
        " * It requires the Identify Existing User node before it is being called.",
        " * ",
        " * The Scripted Decision Node needs the following outcomes defined:",
        " * - true",
        " * - false",
        " */",
        "logger.warning(\"UOP Enrich Session: start\");",
        "outcome = \"false\";",
        "",
        "if (sharedState.get(\"uopCurrentClassID\")) {",
        "    outcome = \"true\";",
        "    logger.warning(\"UOP Enrich Session: going to enrich session with class id: \".concat(sharedState.get(\"uopCurrentClassID\")));",
        "  ",
        "    var fr = JavaImporter(",
        "      org.forgerock.openam.auth.node.api",
        "    );",
        "",
        "    with (fr) {",
        "        logger.warning(\"UOP Enrich Session: End (outcome=\".concat(outcome).concat(\")\"));",
        "        action = Action.goTo(outcome).putSessionProperty(\"UOPClassID\", sharedState.get(\"uopCurrentClassID\")).build();",
        "    }",
        "  ",
        "} else {",
        "    logger.error(\"UOP Enrich Session: no classes!\");",
        "    logger.warning(\"UOP Enrich Session: End (outcome=\".concat(outcome).concat(\")\"));",
        "}"
      ]
    }
  }
}